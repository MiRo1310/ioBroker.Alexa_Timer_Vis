{
  "version": 3,
  "sources": ["../../src/lib/timer-name.ts"],
  "sourcesContent": ["import { useStore } from \"../store/store\";\nimport { isIobrokerValue } from \"./global\";\nimport { timerObject, TimerSelector } from \"./timer-data\";\n\nconst oldJson: AlexaActiveTimerList[] = [];\ninterface AlexaActiveTimerList {\n\tid: string;\n\tlabel: string | null;\n\ttriggerTime: number;\n}\n\nexport const getNewTimerName = (newJsonString: ioBroker.State, timerSelector: string): void => {\n\tconst { _this } = useStore();\n\n\tlet newJson: AlexaActiveTimerList[] = [];\n\ttry {\n\t\tif (isIobrokerValue(newJsonString)) {\n\t\t\tnewJson = JSON.parse(newJsonString.val as string);\n\t\t}\n\t\t_this.log.debug(\"NewJson: \" + JSON.stringify(newJson));\n\t\tif (!oldJson || (oldJson.length === 0 && newJson.length)) {\n\t\t\ttimerObject.timer[timerSelector as keyof typeof timerObject.timer].nameFromAlexa = newJson[0]?.label;\n\t\t}\n\n\t\tfor (let i = 0; i < newJson.length; i++) {\n\t\t\tconst elementExist = oldJson.find((oldElement: any) => {\n\t\t\t\tif (oldElement.id === newJson[i].id) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!elementExist) {\n\t\t\t\ttimerObject.timer[timerSelector as keyof typeof timerObject.timer].nameFromAlexa = newJson[i].label;\n\t\t\t}\n\t\t}\n\t} catch (e: any) {\n\t\t_this.log.error(\"Error in checkForNewTimerInObject: \" + JSON.stringify(e));\n\t\t_this.log.error(e.stack);\n\t}\n};\n\nexport const registerIdToGetTimerName = async (timerSelector: TimerSelector): Promise<void> => {\n\tconst store = useStore();\n\tconst _this = store._this;\n\ttry {\n\t\tconst serial = store.deviceSerialNumber;\n\t\tif (!serial) {\n\t\t\treturn;\n\t\t}\n\t\tconst foreignId = `alexa2.${store.getAlexaInstanceObject().instance}.Echo-Devices.${serial}.Timer.activeTimerList`;\n\t\tstore.lastTimers.push({ timerSerial: serial, timerSelector: timerSelector as string, id: foreignId });\n\n\t\tawait _this.subscribeForeignStatesAsync(foreignId);\n\t} catch (e: any) {\n\t\t_this.log.error(\"Error in getName: \" + JSON.stringify(e));\n\t\t_this.log.error(e.stack);\n\t}\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAyB;AACzB,oBAAgC;AAChC,wBAA2C;AAE3C,MAAM,UAAkC,CAAC;AAOlC,MAAM,kBAAkB,CAAC,eAA+B,kBAAgC;AAX/F;AAYC,QAAM,EAAE,MAAM,QAAI,uBAAS;AAE3B,MAAI,UAAkC,CAAC;AACvC,MAAI;AACH,YAAI,+BAAgB,aAAa,GAAG;AACnC,gBAAU,KAAK,MAAM,cAAc,GAAa;AAAA,IACjD;AACA,UAAM,IAAI,MAAM,cAAc,KAAK,UAAU,OAAO,CAAC;AACrD,QAAI,CAAC,WAAY,QAAQ,WAAW,KAAK,QAAQ,QAAS;AACzD,oCAAY,MAAM,aAA+C,EAAE,iBAAgB,aAAQ,CAAC,MAAT,mBAAY;AAAA,IAChG;AAEA,aAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACxC,YAAM,eAAe,QAAQ,KAAK,CAAC,eAAoB;AACtD,YAAI,WAAW,OAAO,QAAQ,CAAC,EAAE,IAAI;AACpC,iBAAO;AAAA,QACR;AAAA,MACD,CAAC;AACD,UAAI,CAAC,cAAc;AAClB,sCAAY,MAAM,aAA+C,EAAE,gBAAgB,QAAQ,CAAC,EAAE;AAAA,MAC/F;AAAA,IACD;AAAA,EACD,SAAS,GAAQ;AAChB,UAAM,IAAI,MAAM,wCAAwC,KAAK,UAAU,CAAC,CAAC;AACzE,UAAM,IAAI,MAAM,EAAE,KAAK;AAAA,EACxB;AACD;AAEO,MAAM,2BAA2B,OAAO,kBAAgD;AAC9F,QAAM,YAAQ,uBAAS;AACvB,QAAM,QAAQ,MAAM;AACpB,MAAI;AACH,UAAM,SAAS,MAAM;AACrB,QAAI,CAAC,QAAQ;AACZ;AAAA,IACD;AACA,UAAM,YAAY,UAAU,MAAM,uBAAuB,EAAE,QAAQ,iBAAiB,MAAM;AAC1F,UAAM,WAAW,KAAK,EAAE,aAAa,QAAQ,eAAwC,IAAI,UAAU,CAAC;AAEpG,UAAM,MAAM,4BAA4B,SAAS;AAAA,EAClD,SAAS,GAAQ;AAChB,UAAM,IAAI,MAAM,uBAAuB,KAAK,UAAU,CAAC,CAAC;AACxD,UAAM,IAAI,MAAM,EAAE,KAAK;AAAA,EACxB;AACD;",
  "names": []
}
